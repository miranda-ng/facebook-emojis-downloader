<?php
include "portable-utf8.php";
 
$json = '[{
    "name" : "\u00dasm\u011bvy a lid\u00e9",
    "icon" : [128515],
    "emojis" : [[128512], [128556], [128513], [128514], [128515], [128516], [128517], [128518], [128519], [128521], [128522], [128578], [128579], [9786], [128523], [128524], [128525], [128536], [128535], [128537], [128538], [128540], [128541], [128539], [129297], [129299], [128526], [129303], [128527], [128566], [128528], [128529], [128530], [128580], [129300], [128563], [128542], [128543], [128544], [128545], [128532], [128533], [128577], [9785], [128547], [128534], [128555], [128553], [128548], [128558], 
    [128561], [128552], [128560], [128559], [128550], [128551], [128549], [128546], [128554], [128531], [128557], [128565], [128562], [129296], [128567], [129298], [129301], [128564], [128164], [128169], [128520], [128127], [128121], [128122], [128128], [128123], [128125], [129302], [128570], [128568], [128569], [128571], [128572], [128573], [128576], [128575], [128574], [128588], [128079], [128075], [128077], [128078], [128074], [9994], [9996], [128076], [9995], [128080], [128170], [128591], [9757], 
    [128070], [128071], [128072], [128073], [128405], [128400], [129304], [128406], [9997], [128133], [128068], [128069], [128066], [128067], [128065], [128064], [128100], [128101], [128483], [128118], [128102], [128103], [128104], [128105], [128113], [128116], [128117], [128114], [128115], [128110], [128119], [9937], [128130], [128373], [127877], [128124], [128120], [128112], [128694], [127939], [128131], [128111], [128107], [128108], [128109], [128583], [128129], [128581], [128582], [128587], [128590], 
    [128589], [128135], [128134], [128145], [128105, 8205, 10084, 65039, 8205, 128104], [128104, 8205, 10084, 65039, 8205, 128104], [128105, 8205, 10084, 65039, 8205, 128105], [128143], [128105, 8205, 10084, 65039, 8205, 128139, 8205, 128104], [128104, 8205, 10084, 65039, 8205, 128139, 8205, 128104], [128105, 8205, 10084, 65039, 8205, 128139, 8205, 128105], [128106], [128104, 8205, 128105, 8205, 128102], [128104, 8205, 128105, 8205, 128103], [128104, 8205, 128105, 8205, 128103, 8205, 128102], [128104, 
    8205, 128105, 8205, 128102, 8205, 128102], [128104, 8205, 128105, 8205, 128103, 8205, 128103], [128105, 8205, 128105, 8205, 128102], [128105, 8205, 128105, 8205, 128103], [128105, 8205, 128105, 8205, 128103, 8205, 128102], [128105, 8205, 128105, 8205, 128102, 8205, 128102], [128105, 8205, 128105, 8205, 128103, 8205, 128103], [127995], [127996], [127997], [127998], [127999], [128104, 8205, 128104, 8205, 128102], [128104, 8205, 128104, 8205, 128103], [128104, 8205, 128104, 8205, 128103, 8205, 128102], 
    [128104, 8205, 128104, 8205, 128102, 8205, 128102], [128104, 8205, 128104, 8205, 128103, 8205, 128103], [128090], [128085], [128086], [128084], [128087], [128089], [128088], [128132], [128139], [128099], [128096], [128097], [128098], [128094], [128095], [128082], [127913], [127891], [128081], [127890], [128093], [128091], [128092], [128188], [128083], [128374], [128141], [127746]]
  }, {
    "name" : "Zv\u00ed\u0159ata a p\u0159\u00edroda",
    "icon" : [128059],
    "emojis" : [[128054], [128049], [128045], [128057], [128048], [128059], [128060], [128040], [128047], [129409], [128046], [128055], [128061], [128056], [128025], [128053], [128584], [128585], [128586], [128018], [128039], [128038], [128036], [128035], [128037], [128058], [128023], [128052], [129412], [128029], [128027], [128012], [128030], [128028], [128375], [129410], [129408], [128013], [128034], [128032], [128031], [128033], [128044], [128051], [128011], [128010], [128006], [128005], [128003], 
    [128002], [128020], [128004], [128042], [128043], [128024], [128016], [128015], [128017], [128014], [128022], [128E3], [128001], [128019], [129411], [128330], [128021], [128041], [128008], [128007], [128063], [128062], [128009], [128050], [127797], [127876], [127794], [127795], [127796], [127793], [127807], [9752], [127808], [127885], [127883], [127811], [127810], [127809], [127806], [127802], [127803], [127801], [127804], [127799], [127800], [127812], [128144], [127792], [127875], [128026], 
    [128376], [127758], [127757], [127759], [127765], [127766], [127767], [127768], [127761], [127762], [127763], [127764], [127770], [127773], [127771], [127772], [127774], [127769], [11088], [127775], [128171], [10024], [9732], [9728], [9925], [127780], [127781], [127782], [9729], [127783], [9928], [127785], [9889], [128293], [128165], [10052], [127784], [9731], [9924], [127788], [128168], [127786], [127787], [9730], [9748], [128167], [128166], [127754]]
  }, {
    "name" : "J\u00eddlo a pit\u00ed",
    "icon" : [127828],
    "emojis" : [[127823], [127822], [127824], [127818], [127819], [127820], [127817], [127815], [127827], [127816], [127826], [127825], [127821], [127813], [127814], [127798], [127805], [127840], [127838], [129472], [127831], [127830], [127844], [127859], [127828], [127839], [127789], [127829], [127837], [127790], [127791], [127836], [127858], [127845], [127843], [127857], [127835], [127833], [127834], [127832], [127842], [127841], [127847], [127848], [127846], [127856], [127855], [127874], [127854], 
    [127852], [127853], [127851], [127871], [127849], [127850], [127866], [127867], [127863], [127864], [127865], [127870], [127862], [127861], [9749], [127868], [127860], [127869]]
  }, {
    "name" : "Aktivity",
    "icon" : [9917],
    "emojis" : [[9917], [127936], [127944], [9918], [127934], [127952], [127945], [127921], [9971], [127948], [127955], [127992], [127954], [127953], [127951], [127935], [9975], [127938], [9976], [127993], [127907], [128675], [127946], [127940], [9977], [127947], [128692], [128693], [127943], [128372], [127942], [127933], [127894], [127941], [127895], [127989], [127915], [127903], [127917], [127912], [127914], [127908], [127911], [127932], [127929], [127927], [127930], [127928], [127931], [127916], 
    [127918], [128126], [127919], [127922], [127920], [127923]]
  }, {
    "name" : "Cestov\u00e1n\u00ed a m\u00edsta",
    "icon" : [128662],
    "emojis" : [[128663], [128661], [128647], [128665], [128652], [128654], [127950], [128659], [128657], [128658], [128656], [128666], [128667], [128668], [127949], [128690], [128680], [128653], [128664], [128660], [128662], [128673], [128672], [128671], [128643], [128651], [128669], [128644], [128645], [128648], [128670], [128642], [128646], [128650], [128649], [128641], [128745], [9992], [128747], [128748], [9973], [128741], [128676], [9972], [128755], [128640], [128752], [128186], [9875], [128679], 
    [9981], [128655], [128678], [128677], [127937], [128674], [127905], [127906], [127959], [127904], [127745], [128508], [127981], [9970], [127889], [9968], [127956], [128507], [127755], [128510], [127957], [127966], [128739], [128740], [127749], [127748], [127964], [127958], [9969], [127965], [127751], [127750], [127961], [127747], [127753], [127756], [127879], [127878], [127752], [127960], [127984], [127983], [127967], [128509], [127968], [127969], [127962], [127970], [127980], [9978], [127971], 
    [127972], [127973], [127974], [127976], [127978], [127979], [127977], [127963], [128146], [9962], [128332], [128333], [128331], [9961], [127776]]
  }, {
    "name" : "Objekty",
    "icon" : [128161],
    "emojis" : [[8986], [128241], [128242], [128187], [9E3], [128421], [128424], [128433], [128434], [128377], [128189], [128190], [128191], [128192], [128252], [128247], [128248], [128249], [127909], [128253], [127902], [128222], [9742], [128223], [128224], [128250], [128251], [127897], [127898], [127899], [9201], [9202], [9200], [128368], [8987], [9203], [128225], [128267], [128268], [128161], [128294], [128367], [128465], [128738], [128184], [128181], [128180], [128182], [128183], [128176], [128179], 
    [128142], [9878], [128295], [128296], [9874], [128736], [9935], [128297], [128476], [9881], [9939], [128299], [128163], [128298], [128481], [9876], [128737], [128684], [9760], [9904], [9905], [127994], [128302], [128255], [128136], [9879], [128301], [128300], [128371], [128138], [128137], [127777], [127991], [128278], [128701], [128703], [128704], [128705], [128273], [128477], [128715], [128716], [128719], [128682], [128718], [128444], [128506], [128511], [128717], [127880], [127887], [127872], 
    [127873], [127882], [127881], [127886], [127888], [127884], [127982], [9993], [128233], [128232], [128140], [128231], [128238], [128234], [128235], [128236], [128237], [128230], [128239], [128229], [128228], [128220], [128195], [128209], [128202], [128200], [128201], [128196], [128197], [128198], [128467], [128199], [128451], [128499], [128452], [128203], [128466], [128193], [128478], [128194], [128450], [128240], [128211], [128213], [128215], [128216], [128217], [128212], [128210], [128218], 
    [128214], [128279], [128206], [128391], [9986], [128208], [128207], [128204], [128205], [128681], [127987], [127988], [128272], [128274], [128275], [128271], [128394], [128395], [10002], [128221], [9999], [128397], [128396], [128269], [128270]]
  }, {
    "name" : "Symboly",
    "icon" : [10084],
    "emojis" : [[10084, 65039], [128155], [128154], [128153], [128148], [128156], [10083], [128149], [128147], [128158], [128151], [128152], [128150], [128157], [128159], [9774], [10013], [9770], [128329], [9784], [10017], [128303], [128334], [9775], [9766], [128720], [9934], [9800], [9801], [9802], [9803], [9804], [9805], [9806], [9807], [9808], [9809], [9810], [9811], [127380], [9883], [9762], [9763], [128244], [128243], [127543], [127386], [128174], [127344], [127345], [127374], [127377], [127358], 
    [127384], [9940], [128219], [128683], [10060], [11093], [128162], [9832], [128695], [128687], [128691], [128689], [128286], [128245], [10071], [10069], [10067], [10068], [8252, 65039], [8265, 65039], [128175], [128261], [128262], [128305], [9884], [12349], [9888], [128696], [128304], [127535], [128185], [10035], [10062], [9989], [128160], [127744], [127760], [9410], [127975], [127490], [128706], [128707], [128708], [128709], [9855], [128685], [128702], [10036], [127359], [128688], [128697], [128698], 
    [128700], [128699], [128686], [127910], [128246], [9167], [127489], [127382], [9851], [127383], [127378], [10055], [127381], [127379], [35, 8419], [42, 8419], [48, 8419], [49, 8419], [50, 8419], [51, 8419], [52, 8419], [53, 8419], [54, 8419], [55, 8419], [56, 8419], [57, 8419], [128287], [128290], [9654], [9208], [9199], [9209], [9210], [9197], [9198], [9194], [128256], [128257], [9193], [128258], [9664], [128316], [128317], [9195], [9196], [127385], [10145], [11013], [11014], [11015], [8599], 
    [8600], [8601], [8598], [8596], [8618], [128260], [8617], [10548], [10549], [8505], [8597], [128292], [128289], [128288], [128291], [127925], [127926], [12336], [10175], [10004], [128259], [10133], [10134], [10135], [10006], [10160], [128178], [128177], [169, 65039], [174, 65039], [8482, 65039], [128282], [128281], [128283], [128285], [128284], [9745], [128280], [9898], [9899], [128308], [128309], [128313], [128312], [128310], [128311], [128314], [9642], [9643], [9724], [9723], [128315], [11035], 
    [11036], [9726], [9725], [128306], [128307], [128264], [128265], [128266], [128263], [128227], [128226], [128276], [126980], [128277], [127183], [9824], [9827], [9829], [9830], [127924], [128065, 8205, 128488], [128488], [128173], [128495], [128172], [128336], [128337], [128338], [128339], [128340], [128341], [128342], [128343], [128344], [128345], [128346], [128347], [128348], [128349], [128350], [128351], [128352], [128353], [128354], [128355], [128356], [128357], [128358], [128359], [127542], 
    [127568], [127545], [127514], [127538], [127569], [127544], [127540], [127539], [12951, 65039], [12953, 65039], [127546], [127541]]
  }, {
    "name" : "Vlajky",
    "icon" : [983041],
    "emojis" : [[127482, 127480], [127462, 127464], [127482, 127486], [127462, 127465], [127482, 127487], [127462, 127466], [127483, 127462], [127462, 127467], [127483, 127464], [127462, 127468], [127483, 127466], [127462, 127470], [127483, 127468], [127462, 127473], [127483, 127470], [127462, 127474], [127483, 127475], [127462, 127476], [127483, 127482], [127462, 127478], [127484, 127467], [127462, 127479], [127484, 127480], [127462, 127480], [127485, 127472], [127462, 127481], [127486, 127466], [127462, 
    127482], [127486, 127481], [127462, 127484], [127487, 127462], [127462, 127485], [127487, 127474], [127462, 127487], [127487, 127484], [127463, 127462], [127463, 127463], [127463, 127465], [127463, 127466], [127463, 127467], [127463, 127468], [127463, 127469], [127463, 127470], [127463, 127471], [127463, 127473], [127463, 127474], [127463, 127475], [127463, 127476], [127463, 127478], [127463, 127479], [127463, 127480], [127463, 127481], [127463, 127483], [127463, 127484], [127463, 127486], [127463, 
    127487], [127464, 127462], [127464, 127464], [127464, 127465], [127464, 127467], [127464, 127468], [127464, 127469], [127464, 127470], [127464, 127472], [127464, 127473], [127464, 127474], [127464, 127475], [127464, 127476], [127464, 127477], [127464, 127479], [127464, 127482], [127464, 127483], [127464, 127484], [127464, 127485], [127464, 127486], [127464, 127487], [127465, 127466], [127465, 127468], [127465, 127471], [127465, 127472], [127465, 127474], [127465, 127476], [127465, 127487], [127466, 
    127462], [127466, 127464], [127466, 127466], [127466, 127468], [127466, 127469], [127466, 127479], [127466, 127480], [127466, 127481], [127466, 127482], [127467, 127470], [127467, 127471], [127467, 127472], [127467, 127474], [127467, 127476], [127467, 127479], [127468, 127462], [127468, 127463], [127468, 127465], [127468, 127466], [127468, 127467], [127468, 127468], [127468, 127469], [127468, 127470], [127468, 127473], [127468, 127474], [127468, 127475], [127468, 127477], [127468, 127478], [127468, 
    127479], [127468, 127480], [127468, 127481], [127468, 127482], [127468, 127484], [127468, 127486], [127469, 127472], [127469, 127474], [127469, 127475], [127469, 127479], [127469, 127481], [127469, 127482], [127470, 127464], [127470, 127465], [127470, 127466], [127470, 127473], [127470, 127474], [127470, 127475], [127470, 127476], [127470, 127478], [127470, 127479], [127470, 127480], [127470, 127481], [127471, 127466], [127471, 127474], [127471, 127476], [127471, 127477], [127472, 127466], [127472, 
    127468], [127472, 127469], [127472, 127470], [127472, 127474], [127472, 127475], [127472, 127477], [127472, 127479], [127472, 127484], [127472, 127486], [127472, 127487], [127473, 127462], [127473, 127463], [127473, 127464], [127473, 127470], [127473, 127472], [127473, 127479], [127473, 127480], [127473, 127481], [127473, 127482], [127473, 127483], [127473, 127486], [127474, 127462], [127474, 127464], [127474, 127465], [127474, 127466], [127474, 127467], [127474, 127468], [127474, 127469], [127474, 
    127472], [127474, 127473], [127474, 127474], [127474, 127475], [127474, 127476], [127474, 127477], [127474, 127478], [127474, 127479], [127474, 127480], [127474, 127481], [127474, 127482], [127474, 127483], [127474, 127484], [127474, 127485], [127474, 127486], [127474, 127487], [127475, 127462], [127475, 127464], [127475, 127466], [127475, 127467], [127475, 127468], [127475, 127470], [127475, 127473], [127475, 127476], [127475, 127477], [127475, 127479], [127475, 127482], [127475, 127487], [127476, 
    127474], [127477, 127462], [127477, 127466], [127477, 127467], [127477, 127468], [127477, 127469], [127477, 127472], [127477, 127473], [127477, 127474], [127477, 127475], [127477, 127479], [127477, 127480], [127477, 127481], [127477, 127484], [127477, 127486], [127478, 127462], [127479, 127466], [127479, 127476], [127479, 127480], [127479, 127482], [127479, 127484], [127480, 127462], [127480, 127463], [127480, 127464], [127480, 127465], [127480, 127466], [127480, 127468], [127480, 127469], [127480, 
    127470], [127480, 127471], [127480, 127472], [127480, 127473], [127480, 127474], [127480, 127475], [127480, 127476], [127480, 127479], [127480, 127480], [127480, 127481], [127480, 127483], [127480, 127485], [127480, 127486], [127480, 127487], [127481, 127462], [127481, 127464], [127481, 127465], [127481, 127467], [127481, 127468], [127481, 127469], [127481, 127471], [127481, 127472], [127481, 127473], [127481, 127474], [127481, 127475], [127481, 127476], [127481, 127479], [127481, 127481], [127481, 
    127483], [127481, 127484], [127481, 127487], [127482, 127462], [127482, 127468], [127482, 127474]]
  }]';
  
$emojisdata = json_decode($json, true);
 
$emojis = [];
 
foreach ($emojisdata as $category) {
	array_unshift($category["emojis"], $category["icon"]);
	
	foreach ($category["emojis"] as $emoji) {
		$arr = [];
		foreach ($emoji as $code) {
			$hex = base_convert($code, 10, 16);
			$arr[] = $hex;
		}
		$emojis[] = implode("_", $arr);
	}
}

/*$emojis = ["1f004", "1f0cf", "1f170", "1f171", "1f17e", "1f17f", "1f18e", "1f191", "1f192", "1f193", "1f194", "1f195", "1f196", "1f197", "1f198", "1f199", "1f19a", "1f1e6_1f1ea", "1f1e6_1f1f9", "1f1e6_1f1fa", "1f1e7_1f1ea", "1f1e7_1f1f7", "1f1e8_1f1e6", "1f1e8_1f1ed", "1f1e8_1f1f1", "1f1e8_1f1f3", "1f1e8_1f1f4", "1f1e9_1f1ea", "1f1e9_1f1f0", "1f1ea_1f1f8", "1f1eb_1f1ee", "1f1eb_1f1f7", "1f1ec_1f1e7", "1f1ed_1f1f0", "1f1ee_1f1e9", "1f1ee_1f1ea", "1f1ee_1f1f1", "1f1ee_1f1f3", "1f1ee_1f1f9", "1f1ef_1f1f5", "1f1f0_1f1f7", "1f1f2_1f1f4", "1f1f2_1f1fd", "1f1f2_1f1fe", "1f1f3_1f1f1", "1f1f3_1f1f4", "1f1f3_1f1ff", "1f1f5_1f1ed", "1f1f5_1f1f1", "1f1f5_1f1f7", "1f1f5_1f1f9", "1f1f7_1f1fa", "1f1f8_1f1e6", "1f1f8_1f1ea", "1f1f8_1f1ec", "1f1f9_1f1f7", "1f1fa_1f1f8", "1f1fb_1f1f3", "1f1ff_1f1e6", "1f201", "1f202", "1f21a", "1f22f", "1f232", "1f233", "1f234", "1f235", "1f236", "1f237", "1f238", "1f239", "1f23a", "1f250", "1f251", "1f300", "1f301", "1f302", "1f303", "1f304", "1f305", "1f306", "1f307", "1f308", "1f309", "1f30a", "1f30b", "1f30c", "1f30d", "1f30e", "1f30f", "1f310", "1f311", "1f312", "1f313", "1f314", "1f315", "1f316", "1f317", "1f318", "1f319", "1f31a", "1f31b", "1f31c", "1f31d", "1f31e", "1f31f", "1f320", "1f330", "1f331", "1f332", "1f333", "1f334", "1f335", "1f337", "1f338", "1f339", "1f33a", "1f33b", "1f33c", "1f33d", "1f33e", "1f33f", "1f340", "1f341", "1f342", "1f343", "1f344", "1f345", "1f346", "1f347", "1f348", "1f349", "1f34a", "1f34b", "1f34c", "1f34d", "1f34e", "1f34f", "1f350", "1f351", "1f352", "1f353", "1f354", "1f355", "1f356", "1f357", "1f358", "1f359", "1f35a", "1f35b", "1f35c", "1f35d", "1f35e", "1f35f", "1f360", "1f361", "1f362", "1f363", "1f364", "1f365", "1f366", "1f367", "1f368", "1f369", "1f36a", "1f36b", "1f36c", "1f36d", "1f36e", "1f36f", "1f370", "1f371", "1f372", "1f373", "1f374", "1f375", "1f376", "1f377", "1f378", "1f379", "1f37a", "1f37b", "1f37c", "1f380", "1f381", "1f382", "1f383", "1f384", "1f385", "1f385_1f3fb", "1f385_1f3fc", "1f385_1f3fd", "1f385_1f3fe", "1f385_1f3ff", "1f386", "1f387", "1f388", "1f389", "1f38a", "1f38b", "1f38c", "1f38d", "1f38e", "1f38f", "1f390", "1f391", "1f392", "1f393", "1f3a0", "1f3a1", "1f3a2", "1f3a3", "1f3a4", "1f3a5", "1f3a6", "1f3a7", "1f3a8", "1f3a9", "1f3aa", "1f3ab", "1f3ac", "1f3ad", "1f3ae", "1f3af", "1f3b0", "1f3b1", "1f3b2", "1f3b3", "1f3b4", "1f3b5", "1f3b6", "1f3b7", "1f3b8", "1f3b9", "1f3ba", "1f3bb", "1f3bc", "1f3bd", "1f3be", "1f3bf", "1f3c0", "1f3c1", "1f3c2", "1f3c2_1f3fb", "1f3c2_1f3fc", "1f3c2_1f3fd", "1f3c2_1f3fe", "1f3c2_1f3ff", "1f3c3", "1f3c3_1f3fb", "1f3c3_1f3fc", "1f3c3_1f3fd", "1f3c3_1f3fe", "1f3c3_1f3ff", "1f3c4", "1f3c4_1f3fb", "1f3c4_1f3fc", "1f3c4_1f3fd", "1f3c4_1f3fe", "1f3c4_1f3ff", "1f3c6", "1f3c7", "1f3c7_1f3fb", "1f3c7_1f3fc", "1f3c7_1f3fd", "1f3c7_1f3fe", "1f3c7_1f3ff", "1f3c8", "1f3c9", "1f3ca", "1f3ca_1f3fb", "1f3ca_1f3fc", "1f3ca_1f3fd", "1f3ca_1f3fe", "1f3ca_1f3ff", "1f3e0", "1f3e1", "1f3e2", "1f3e3", "1f3e4", "1f3e5", "1f3e6", "1f3e7", "1f3e8", "1f3e9", "1f3ea", "1f3eb", "1f3ec", "1f3ed", "1f3ee", "1f3ef", "1f3f0", "1f400", "1f401", "1f402", "1f403", "1f404", "1f405", "1f406", "1f407", "1f408", "1f409", "1f40a", "1f40b", "1f40c", "1f40d", "1f40e", "1f40f", "1f410", "1f411", "1f412", "1f413", "1f414", "1f415", "1f416", "1f417", "1f418", "1f419", "1f41a", "1f41b", "1f41c", "1f41d", "1f41e", "1f41f", "1f420", "1f421", "1f422", "1f423", "1f424", "1f425", "1f426", "1f427", "1f428", "1f429", "1f42a", "1f42b", "1f42c", "1f42d", "1f42e", "1f42f", "1f430", "1f431", "1f432", "1f433", "1f434", "1f435", "1f436", "1f437", "1f438", "1f439", "1f43a", "1f43b", "1f43c", "1f43d", "1f43e", "1f440", "1f442", "1f442_1f3fb", "1f442_1f3fc", "1f442_1f3fd", "1f442_1f3fe", "1f442_1f3ff", "1f443", "1f443_1f3fb", "1f443_1f3fc", "1f443_1f3fd", "1f443_1f3fe", "1f443_1f3ff", "1f444", "1f445", "1f446", "1f446_1f3fb", "1f446_1f3fc", "1f446_1f3fd", "1f446_1f3fe", "1f446_1f3ff", "1f447", "1f447_1f3fb", "1f447_1f3fc", "1f447_1f3fd", "1f447_1f3fe", "1f447_1f3ff", "1f448", "1f448_1f3fb", "1f448_1f3fc", "1f448_1f3fd", "1f448_1f3fe", "1f448_1f3ff", "1f449", "1f449_1f3fb", "1f449_1f3fc", "1f449_1f3fd", "1f449_1f3fe", "1f449_1f3ff", "1f44a", "1f44a_1f3fb", "1f44a_1f3fc", "1f44a_1f3fd", "1f44a_1f3fe", "1f44a_1f3ff", "1f44b", "1f44b_1f3fb", "1f44b_1f3fc", "1f44b_1f3fd", "1f44b_1f3fe", "1f44b_1f3ff", "1f44c", "1f44c_1f3fb", "1f44c_1f3fc", "1f44c_1f3fd", "1f44c_1f3fe", "1f44c_1f3ff", "1f44d", "1f44d_1f3fb", "1f44d_1f3fc", "1f44d_1f3fd", "1f44d_1f3fe", "1f44d_1f3ff", "1f44e", "1f44e_1f3fb", "1f44e_1f3fc", "1f44e_1f3fd", "1f44e_1f3fe", "1f44e_1f3ff", "1f44f", "1f44f_1f3fb", "1f44f_1f3fc", "1f44f_1f3fd", "1f44f_1f3fe", "1f44f_1f3ff", "1f450", "1f450_1f3fb", "1f450_1f3fc", "1f450_1f3fd", "1f450_1f3fe", "1f450_1f3ff", "1f451", "1f452", "1f453", "1f454", "1f455", "1f456", "1f457", "1f458", "1f459", "1f45a", "1f45b", "1f45c", "1f45d", "1f45e", "1f45f", "1f460", "1f461", "1f462", "1f463", "1f464", "1f465", "1f466", "1f466_1f3fb", "1f466_1f3fc", "1f466_1f3fd", "1f466_1f3fe", "1f466_1f3ff", "1f467", "1f467_1f3fb", "1f467_1f3fc", "1f467_1f3fd", "1f467_1f3fe", "1f467_1f3ff", "1f468", "1f468_1f3fb", "1f468_1f3fc", "1f468_1f3fd", "1f468_1f3fe", "1f468_1f3ff", "1f468_200d_1f468_200d_1f466", "1f468_200d_1f468_200d_1f466_200d_1f466", "1f468_200d_1f468_200d_1f467", "1f468_200d_1f468_200d_1f467_200d_1f466", "1f468_200d_1f468_200d_1f467_200d_1f467", "1f468_200d_1f469_200d_1f466", "1f468_200d_1f469_200d_1f466_200d_1f466", "1f468_200d_1f469_200d_1f467", "1f468_200d_1f469_200d_1f467_200d_1f466", "1f468_200d_1f469_200d_1f467_200d_1f467", "1f468_200d_2764_fe0f_200d_1f468", "1f468_200d_2764_fe0f_200d_1f48b_200d_1f468", "1f469", "1f469_1f3fb", "1f469_1f3fc", "1f469_1f3fd", "1f469_1f3fe", "1f469_1f3ff", "1f469_200d_1f469_200d_1f466", "1f469_200d_1f469_200d_1f466_200d_1f466", "1f469_200d_1f469_200d_1f467", "1f469_200d_1f469_200d_1f467_200d_1f466", "1f469_200d_1f469_200d_1f467_200d_1f467", "1f469_200d_2764_fe0f_200d_1f469", "1f469_200d_2764_fe0f_200d_1f48b_200d_1f469", "1f46a", "1f46b", "1f46b_1f3fb", "1f46b_1f3fc", "1f46b_1f3fd", "1f46c", "1f46d", "1f46e", "1f46e_1f3fb", "1f46e_1f3fc", "1f46e_1f3fd", "1f46e_1f3fe", "1f46e_1f3ff", "1f46f", "1f470", "1f470_1f3fb", "1f470_1f3fc", "1f470_1f3fd", "1f470_1f3fe", "1f470_1f3ff", "1f471", "1f471_1f3fb", "1f471_1f3fc", "1f471_1f3fd", "1f471_1f3fe", "1f471_1f3ff", "1f472", "1f472_1f3fb", "1f472_1f3fc", "1f472_1f3fd", "1f472_1f3fe", "1f472_1f3ff", "1f473", "1f473_1f3fb", "1f473_1f3fc", "1f473_1f3fd", "1f473_1f3fe", "1f473_1f3ff", "1f474", "1f474_1f3fb", "1f474_1f3fc", "1f474_1f3fd", "1f474_1f3fe", "1f474_1f3ff", "1f475", "1f475_1f3fb", "1f475_1f3fc", "1f475_1f3fd", "1f475_1f3fe", "1f475_1f3ff", "1f476", "1f476_1f3fb", "1f476_1f3fc", "1f476_1f3fd", "1f476_1f3fe", "1f476_1f3ff", "1f477", "1f477_1f3fb", "1f477_1f3fc", "1f477_1f3fd", "1f477_1f3fe", "1f477_1f3ff", "1f478", "1f478_1f3fb", "1f478_1f3fc", "1f478_1f3fd", "1f478_1f3fe", "1f478_1f3ff", "1f479", "1f47a", "1f47b", "1f47c", "1f47c_1f3fb", "1f47c_1f3fc", "1f47c_1f3fd", "1f47c_1f3fe", "1f47c_1f3ff", "1f47d", "1f47e", "1f47f", "1f480", "1f481", "1f481_1f3fb", "1f481_1f3fc", "1f481_1f3fd", "1f481_1f3fe", "1f481_1f3ff", "1f482", "1f482_1f3fb", "1f482_1f3fc", "1f482_1f3fd", "1f482_1f3fe", "1f482_1f3ff", "1f483", "1f483_1f3fb", "1f483_1f3fc", "1f483_1f3fd", "1f483_1f3fe", "1f483_1f3ff", "1f484", "1f485", "1f485_1f3fb", "1f485_1f3fc", "1f485_1f3fd", "1f485_1f3fe", "1f485_1f3ff", "1f486", "1f486_1f3fb", "1f486_1f3fc", "1f486_1f3fd", "1f486_1f3fe", "1f486_1f3ff", "1f487", "1f487_1f3fb", "1f487_1f3fc", "1f487_1f3fd", "1f487_1f3fe", "1f487_1f3ff", "1f488", "1f489", "1f48a", "1f48b", "1f48c", "1f48d", "1f48e", "1f48f", "1f490", "1f491", "1f492", "1f493", "1f494", "1f495", "1f496", "1f497", "1f498", "1f499", "1f49a", "1f49b", "1f49c", "1f49d", "1f49e", "1f49f", "1f4a0", "1f4a1", "1f4a2", "1f4a3", "1f4a4", "1f4a5", "1f4a6", "1f4a7", "1f4a8", "1f4a9", "1f4aa", "1f4aa_1f3fb", "1f4aa_1f3fc", "1f4aa_1f3fd", "1f4aa_1f3fe", "1f4aa_1f3ff", "1f4ab", "1f4ac", "1f4ad", "1f4ae", "1f4af", "1f4b0", "1f4b1", "1f4b2", "1f4b3", "1f4b4", "1f4b5", "1f4b6", "1f4b7", "1f4b8", "1f4b9", "1f4ba", "1f4bb", "1f4bc", "1f4bd", "1f4be", "1f4bf", "1f4c0", "1f4c1", "1f4c2", "1f4c3", "1f4c4", "1f4c5", "1f4c6", "1f4c7", "1f4c8", "1f4c9", "1f4ca", "1f4cb", "1f4cc", "1f4cd", "1f4ce", "1f4cf", "1f4d0", "1f4d1", "1f4d2", "1f4d3", "1f4d4", "1f4d5", "1f4d6", "1f4d7", "1f4d8", "1f4d9", "1f4da", "1f4db", "1f4dc", "1f4dd", "1f4de", "1f4df", "1f4e0", "1f4e1", "1f4e2", "1f4e3", "1f4e4", "1f4e5", "1f4e6", "1f4e7", "1f4e8", "1f4e9", "1f4ea", "1f4eb", "1f4ec", "1f4ed", "1f4ee", "1f4ef", "1f4f0", "1f4f1", "1f4f2", "1f4f3", "1f4f4", "1f4f5", "1f4f6", "1f4f7", "1f4f9", "1f4fa", "1f4fb", "1f4fc", "1f500", "1f501", "1f502", "1f503", "1f504", "1f505", "1f506", "1f507", "1f508", "1f509", "1f50a", "1f50b", "1f50c", "1f50d", "1f50e", "1f50f", "1f510", "1f511", "1f512", "1f513", "1f514", "1f515", "1f516", "1f517", "1f518", "1f519", "1f51a", "1f51b", "1f51c", "1f51d", "1f51e", "1f51f", "1f520", "1f521", "1f522", "1f523", "1f524", "1f525", "1f526", "1f527", "1f528", "1f529", "1f52a", "1f52b", "1f52c", "1f52d", "1f52e", "1f52f", "1f530", "1f531", "1f532", "1f533", "1f534", "1f535", "1f536", "1f537", "1f538", "1f539", "1f53a", "1f53b", "1f53c", "1f53d", "1f550", "1f551", "1f552", "1f553", "1f554", "1f555", "1f556", "1f557", "1f558", "1f559", "1f55a", "1f55b", "1f55c", "1f55d", "1f55e", "1f55f", "1f560", "1f561", "1f562", "1f563", "1f564", "1f565", "1f566", "1f567", "1f5fb", "1f5fc", "1f5fd", "1f5fe", "1f5ff", "1f600", "1f601", "1f602", "1f603", "1f604", "1f605", "1f606", "1f607", "1f608", "1f609", "1f60a", "1f60b", "1f60c", "1f60d", "1f60e", "1f60f", "1f610", "1f611", "1f612", "1f613", "1f614", "1f615", "1f616", "1f617", "1f618", "1f619", "1f61a", "1f61b", "1f61c", "1f61d", "1f61e", "1f61f", "1f620", "1f621", "1f622", "1f623", "1f624", "1f625", "1f626", "1f627", "1f628", "1f629", "1f62a", "1f62b", "1f62c", "1f62d", "1f62e", "1f62f", "1f630", "1f631", "1f632", "1f633", "1f634", "1f635", "1f636", "1f637", "1f638", "1f639", "1f63a", "1f63b", "1f63c", "1f63d", "1f63e", "1f63f", "1f640", "1f642", "1f645", "1f645_1f3fb", "1f645_1f3fc", "1f645_1f3fd", "1f645_1f3fe", "1f645_1f3ff", "1f646", "1f646_1f3fb", "1f646_1f3fc", "1f646_1f3fd", "1f646_1f3fe", "1f646_1f3ff", "1f647", "1f647_1f3fb", "1f647_1f3fc", "1f647_1f3fd", "1f647_1f3fe", "1f647_1f3ff", "1f648", "1f649", "1f64a", "1f64b", "1f64b_1f3fb", "1f64b_1f3fc", "1f64b_1f3fd", "1f64b_1f3fe", "1f64b_1f3ff", "1f64c", "1f64c_1f3fb", "1f64c_1f3fc", "1f64c_1f3fd", "1f64c_1f3fe", "1f64c_1f3ff", "1f64d", "1f64d_1f3fb", "1f64d_1f3fc", "1f64d_1f3fd", "1f64d_1f3fe", "1f64d_1f3ff", "1f64e", "1f64e_1f3fb", "1f64e_1f3fc", "1f64e_1f3fd", "1f64e_1f3fe", "1f64e_1f3ff", "1f64f", "1f64f_1f3fb", "1f64f_1f3fc", "1f64f_1f3fd", "1f64f_1f3fe", "1f64f_1f3ff", "1f680", "1f681", "1f682", "1f683", "1f684", "1f685", "1f686", "1f687", "1f688", "1f689", "1f68a", "1f68b", "1f68c", "1f68d", "1f68e", "1f68f", "1f690", "1f691", "1f692", "1f693", "1f694", "1f695", "1f696", "1f697", "1f698", "1f699", "1f69a", "1f69b", "1f69c", "1f69d", "1f69e", "1f69f", "1f6a0", "1f6a1", "1f6a2", "1f6a3", "1f6a4", "1f6a5", "1f6a6", "1f6a7", "1f6a8", "1f6a9", "1f6aa", "1f6ab", "1f6ac", "1f6ad", "1f6ae", "1f6af", "1f6b0", "1f6b1", "1f6b2", "1f6b3", "1f6b4", "1f6b4_1f3fb", "1f6b4_1f3fc", "1f6b4_1f3fd", "1f6b4_1f3fe", "1f6b4_1f3ff", "1f6b5", "1f6b5_1f3fb", "1f6b5_1f3fc", "1f6b5_1f3fd", "1f6b5_1f3fe", "1f6b5_1f3ff", "1f6b6", "1f6b6_1f3fb", "1f6b6_1f3fc", "1f6b6_1f3fd", "1f6b6_1f3fe", "1f6b6_1f3ff", "1f6b7", "1f6b8", "1f6b9", "1f6ba", "1f6bb", "1f6bc", "1f6bd", "1f6be", "1f6bf", "1f6c0", "1f6c0_1f3fb", "1f6c0_1f3fc", "1f6c0_1f3fd", "1f6c0_1f3fe", "1f6c0_1f3ff", "1f6c1", "1f6c2", "1f6c3", "1f6c4", "1f6c5", "203c", "21a9", "21aa", "231a", "231b", "23_20e3", "23ea", "23eb", "23ec", "23f0", "23f3", "24c2", "25aa", "25ab", "25b6", "25c0", "25fb", "25fc", "25fd", "25fe", "260e", "261d", "261d_1f3fb", "261d_1f3fc", "261d_1f3fd", "261d_1f3fe", "261d_1f3ff", "263a", "264a", "264b", "264c", "264d", "264e", "264f", "267b", "267f", "26a0", "26a1", "26aa", "26ab", "26bd", "26be", "26c4", "26c5", "26ce", "26d4", "26ea", "26f2", "26f3", "26f5", "26fa", "26fd", "270a", "270a_1f3fb", "270a_1f3fc", "270a_1f3fd", "270a_1f3fe", "270a_1f3ff", "270b", "270b_1f3fb", "270b_1f3fc", "270b_1f3fd", "270b_1f3fe", "270b_1f3ff", "270c", "270c_1f3fb", "270c_1f3fc", "270c_1f3fd", "270c_1f3fe", "270c_1f3ff", "270f", "274c", "274e", "27a1", "27b0", "27bf", "2b05", "2b06", "2b07", "2b1b", "2b1c", "2b50", "2b55", "303d", "30_20e3", "31_20e3", "32_20e3", "33_20e3", "34_20e3", "35_20e3", "36_20e3", "37_20e3", "38_20e3", "39_20e3",

// these were without quotes
"a9", "ae", "f0000", "f0001", "2049", "2122", "2139", "2194", "2195", "2196", "2197", "2198", "2199", "2600", "2601", "2611", "2614", "2615", "2648", "2649", "2650", "2651", "2652", "2653", "2660", "2663", "2665", "2666", "2668", "2693", "2702", "2705", "2708", "2709", "2712", "2714", "2716", "2728", "2733", "2734", "2744", "2747", "2753", "2754", "2755", "2757", "2764", "2795", "2796", "2797", "2934", "2935", "3030", "3297", "3299",

// this was again with quotes
"23e9" ];*/


    $names = [
      ":)" => "slightsmile",
      ":-)" => "slightsmile",
      ":]" => "slightsmile",
      "=)" => "smile",
      "(:" => "slightsmile",
      "(=" => "smile",
      ":(" => "frown",
      ":-(" => "frown",
      ":[" => "frown",
      "=(" => "frown",
      ")=" => "frown",
      ";-P" => "winktongue",
      ";P" => "winktongue",
      ";-p" => "winktongue",
      ";p" => "winktongue",
      ":poop:" => "poop",
      ":P" => "tongue",
      ":-P" => "tongue",
      ":-p" => "tongue",
      ":p" => "tongue",
      "=P" => "tongue",
      "=p" => "tongue",
      "=D" => "grin",
      ":-D" => "slightgrin",
      ":D" => "slightgrin",
      ":o" => "gasp",
      ":-O" => "gasp",
      ":O" => "gasp",
      ":-o" => "gasp",
      ";)" => "wink",
      ";-)" => "wink",
      "8-)" => "glasses",
      "8)" => "glasses",
      "B-)" => "glasses",
      "B)" => "glasses",
      ">:(" => "grumpy",
      ">:-(" => "grumpy",
      ":/" => "unsure",
      ":-/" => "unsure",
      ":\\" => "unsure",
      ":-\\" => "unsure",
      "=/" => "unsure",
      "=\\" => "unsure",
      ":'(" => "cry",
      ":'-(" => "cry",
      "3:)" => "devil",
      "3:-)" => "devil",
      "O:)" => "angel",
      "O:-)" => "angel",
      "0:)" => "angel",
      "0:-)" => "angel",
      ":*" => "kiss",
      ":-*" => "kiss",
      ";-*" => "winkkiss",
      ";*" => "winkkiss",
      "<3" => "heart",
      "&lt;3" => "heart",
      "\u2665" => "heart",
      "^_^" => "kiki",
      "^~^" => "kiki",
      "-_-" => "expressionless",
      ":-|" => "squint",
      ":|" => "squint",
      ">:o" => "upset",
      ">:O" => "upset",
      ">:-O" => "upset",
      ">:-o" => "upset",
      ">_<" => "persevere",
      ">.<" => "persevere",
      "<(\")" => "penguin",
      "O_O" => "flushface",
      "o_o" => "flushface",
      "0_0" => "flushface",
      "T_T" => "crying",
      "T-T" => "crying",
      "ToT" => "crying",
      "-3-" => "flushkiss",
      "'-_-" => "sweating",
      "(y)" => "like",
      ":like:" => "like",
      "(Y)" => "like",
      "(n)" => "dislike",
      "(N)" => "dislike"
	];
	
	$variants = [];
	foreach ($names as $name => $id) {
		if (!isset($variants[$id]))
			$variants[$id] = [];
		
		$variants[$id][] = $name;
	}
	
	$emote2emojis = [
      "slightsmile" => "1f642",
      "smile" => "1f60a",
      "frown" => "1f61e",
      "winktongue" => "1f61c",
      "poop" => "1f4a9",
      "tongue" => "1f61b",
      "slightgrin" => "1f600",
      "grin" => "1f603",
      "gasp" => "1f62e",
      "wink" => "1f609",
      "glasses" => "1f60e",
      "grumpy" => "1f620",
      "unsure" => "1f615",
      "cry" => "1f622",
      "devil" => "1f608",
      "angel" => "1f607",
      "kiss" => "1f617",
      "winkkiss" => "1f618",
      "heart" => "2764",
      "kiki" => "1f60a",
      "expressionless" => "1f611",
      "squint" => "1f610",
      "upset" => "1f620",
      "persevere" => "1f623",
      "penguin" => "1f427",
      "flushface" => "1f633",
      "crying" => "1f62d",
      "flushkiss" => "1f61a",
      "sweating" => "1f613",
      "like" => "f0000",
      "dislike" => "1f44e",
	  
	  // my addition
	  "heart" => "2764"
    ];
	
	$codes2names = [];
	foreach ($emote2emojis as $name => $id) {
		if (!isset($codes2names[$id]))
			$codes2names[$id] = [];
		
		$codes2names[$id][] = $name;
	}
	
	$symbols = [
      "slightsmile" => ":)",
      "smile" => "=)",
      "frown" => ":(",
      "winktongue" => ";-P",
      "poop" => ":poop:",
      "tongue" => ":P",
      "slightgrin" => ":D",
      "grin" => "=D",
      "gasp" => ":o",
      "wink" => ";)",
      "glasses" => "8-)",
      "grumpy" => ">:(",
      "unsure" => ":/",
      "cry" => ":'(",
      "devil" => "3:)",
      "angel" => "O:)",
      "kiss" => ":*",
      "winkkiss" => ";*",
      "heart" => "<3",
      "kiki" => "^_^",
      "expressionless" => "-_-",
      "squint" => ":-|",
      "upset" => ">:o",
      "persevere" => ">_<",
      "penguin" => "<(\")",
      "flushface" => "O_O",
      "crying" => "T_T",
      "flushkiss" => "-3-",
      "sweating" => "'-_-",
      "like" => "(y)",
      "dislike" => "(n)"
    ];


foreach ($codes2names as $code => $id) {
	if (!in_array($code, $emojis)) {
		array_unshift($emojis, $code);
		//$emojis[] = $code;
	}
}


$pixelRatio = 1;
$fileExt = ".png";
$checksumBase = 317426846;
$schemaAuth = "https://static.xx.fbcdn.net/images/emoji.php/v5";

function charCodeAt($string, $offset) {
  $character = substr($string, $offset, 1);
  list(, $ret) = unpack('S', mb_convert_encoding($character, 'UTF-16LE'));
  return $ret;
}

function escape($text, $checksum) {
	// $text = scope.unescape(encodeURIComponent($text));
    /** @type {number} */
    for ($i = 0; $i < strlen($text); $i++) {
      $checksum = ($checksum << 5) - $checksum + charCodeAt($text, $i);
      $checksum &= 4294967295;
    }
    return base_convert(($checksum & 255), 10, 16);
}

function getEmojiUrl($values, $attributes, $type) {
	global $pixelRatio;
	global $checksumBase;
	global $fileExt;
	global $schemaAuth;
	
	$text = $pixelRatio . "/" . $attributes . "/" . $values . $fileExt;
	$code = escape($text, $checksumBase);
	return $schemaAuth . "/" . $type . $code . "/" . $text;
}

/*
var text = jQuery("EmojiConfig").pixelRatio + "/" + opt_attributes + "/" + values + jQuery("EmojiStaticConfig").fileExt;
var code = escape(text, jQuery("EmojiStaticConfig").checksumBase);
return jQuery("EmojiConfig").schemaAuth + "/" + d + code + "/" + text;
*/

ob_end_flush();


$size = 16;

$problems = [];

$problems = Array
(
    0 => "1f643", 1 => "1f911", 2 => "1f913", 3 => "1f917", 4 => "1f644", 5 => "1f914", 6 => "1f641", 7 => "2639", 8 => "1f910", 9 => "1f912", 10 => "1f915", 11 => "1f916", 12 => "1f595", 13 => "1f590", 14 => "1f918", 15 => "1f596", 16 => "270d", 17 => "1f441", 18 => "1f5e3", 19 => "26d1", 20 => "1f575", 21 => "1f469_200d_2764_fe0f_200d_1f468", 22 => "1f469_200d_2764_fe0f_200d_1f48b_200d_1f468", 23 => "1f3fb", 24 => "1f3fc", 25 => "1f3fd", 26 => "1f3fe", 27 => "1f3ff", 28 => "1f576", 29 => "1f981", 30 => "1f984", 31 => "1f577", 32 => "1f982", 33 => "1f980", 34 => "1f983", 35 => "1f54a", 36 => "1f43f", 37 => "2618", 38 => "1f578", 39 => "2604", 40 => "1f324", 41 => "1f325", 42 => "1f326", 43 => "1f327", 44 => "26c8", 45 => "1f329", 46 => "1f328", 47 => "2603", 48 => "1f32c", 49 => "1f32a", 50 => "1f32b", 51 => "2602", 52 => "1f336", 53 => "1f9c0", 54 => "1f32d", 55 => "1f32e", 56 => "1f32f", 57 => "1f37f", 58 => "1f37e", 59 => "1f37d", 60 => "1f3d0", 61 => "1f3cc", 62 => "1f3d3", 63 => "1f3f8", 64 => "1f3d2", 65 => "1f3d1", 66 => "1f3cf", 67 => "26f7", 68 => "26f8", 69 => "1f3f9", 70 => "26f9", 71 => "1f3cb", 72 => "1f574", 73 => "1f396", 74 => "1f3c5", 75 => "1f397", 76 => "1f3f5", 77 => "1f39f", 78 => "1f3ce", 79 => "1f3cd", 80 => "1f6e9", 81 => "1f6eb", 82 => "1f6ec", 83 => "1f6e5", 84 => "26f4", 85 => "1f6f3", 86 => "1f6f0", 87 => "1f3d7", 88 => "26f0", 89 => "1f3d4", 90 => "1f3d5", 91 => "1f3de", 92 => "1f6e3", 93 => "1f6e4", 94 => "1f3dc", 95 => "1f3d6", 96 => "26f1", 97 => "1f3dd", 98 => "1f3d9", 99 => "1f3d8", 100 => "1f3df", 101 => "1f3da", 102 => "1f3db", 103 => "1f54c", 104 => "1f54d", 105 => "1f54b", 106 => "26e9", 107 => "2328", 108 => "1f5a5", 109 => "1f5a8", 110 => "1f5b1", 111 => "1f5b2", 112 => "1f579", 113 => "1f4f8", 114 => "1f4fd", 115 => "1f39e", 116 => "1f399", 117 => "1f39a", 118 => "1f39b", 119 => "23f1", 120 => "23f2", 121 => "1f570", 122 => "1f56f", 123 => "1f5d1", 124 => "1f6e2", 125 => "2696", 126 => "2692", 127 => "1f6e0", 128 => "26cf", 129 => "1f5dc", 130 => "2699", 131 => "26d3", 132 => "1f5e1", 133 => "2694", 134 => "1f6e1", 135 => "2620", 136 => "26b0", 137 => "26b1", 138 => "1f3fa", 139 => "1f4ff", 140 => "2697", 141 => "1f573", 142 => "1f321", 143 => "1f3f7", 144 => "1f5dd", 145 => "1f6cb", 146 => "1f6cc", 147 => "1f6cf", 148 => "1f6ce", 149 => "1f5bc", 150 => "1f5fa", 151 => "1f6cd", 152 => "1f5d3", 153 => "1f5c3", 154 => "1f5f3", 155 => "1f5c4", 156 => "1f5d2", 157 => "1f5de", 158 => "1f5c2", 159 => "1f587", 160 => "1f3f3", 161 => "1f3f4", 162 => "1f58a", 163 => "1f58b", 164 => "1f58d", 165 => "1f58c", 166 => "2764_fe0f", 167 => "2763", 168 => "262e", 169 => "271d", 170 => "262a", 171 => "1f549", 172 => "2638", 173 => "2721", 174 => "1f54e", 175 => "262f", 176 => "2626", 177 => "1f6d0", 178 => "269b", 179 => "2622", 180 => "2623", 181 => "203c_fe0f", 182 => "2049_fe0f", 183 => "269c", 184 => "23cf", 185 => "2a_20e3", 186 => "23f8", 187 => "23ef", 188 => "23f9", 189 => "23fa", 190 => "23ed", 191 => "23ee", 192 => "a9_fe0f", 193 => "ae_fe0f", 194 => "2122_fe0f", 195 => "1f441_200d_1f5e8", 196 => "1f5e8", 197 => "1f5ef", 198 => "3297_fe0f", 199 => "3299_fe0f", 200 => "1f1e7_1f1f3", 201 => "1f1e8_1f1f5", 202 => "f0001"
);

function is_broken($path) {
	if (!file_exists($path))
		return false;
	
	$contents = file_get_contents($path);
	return strpos($contents, "PNG") !== 1;
}

function download($code, $size, $force = false) {
	$url = getEmojiUrl($code, $size, "z");
	$path = "smileys_{$size}/" . $code . ".png";
	global $problems;

	if (!file_exists($path) || $force || is_broken($path)) {
		$contents = @file_get_contents($url);
		if (strlen($contents) > 0) {
			file_put_contents($path, $contents);
			if (is_broken($path)) {
				echo "Downloaded broken: <a href=\"" . $url . "\">" . $url . "</a><br>\n";
			} else {
				echo "Downloaded: " . $url . "<br>\n";
			}
		} else {
			echo "Problem: " . $url . "<br>\n";
			$problems[] = $code;
		}
	} else {
		// echo "Already exists: " . $url . "<br>\n";
	}
}

$i = 0;
// downloading them:
foreach ($emojis as $e) {
	if (!in_array($e, $problems))
		download($e, $size);
	
	flush();
	
	set_time_limit(20);
}


// creating smileypack

mb_internal_encoding('UTF-8');

$file = fopen("smileys_{$size}/facebook.msl", "w");
// Write UTF-8 BOM
fwrite($file, pack("CCC",0xef,0xbb,0xbf)); 

$header = "Name = \"Facebook emoji\"
Author = \"Robert Pösel (Robyer)\"
Date = \"11.09.2016\"
Version = \"1.0\"
SelectionSize = {$size}, {$size}
WindowSize = 10, 8

";


/*echo "---------------------\n<br>";
print_r($problems);
echo "---------------------\n<br>";*/

fwrite($file, $header);

foreach ($emojis as $e) {
	$image = $e . ".png";
	$code = $e;
	
	$unicode = "";
	$codes = explode("_", $code);
	foreach ($codes as $c) {
		$unicode .= utf8_chr($c);
	}

	if (in_array($code, $problems))
		continue;
	
	$line;
	if (isset($codes2names[$code])) {
		$texts = $unicode;
		
		// These are emojis with also textual representation
		$names = $codes2names[$code];
		foreach ($names as $name) {
			if (isset($variants[$name]))
				$texts .= " " . implode(" ", $variants[$name]);
		}
		
		// escape " inside
		$texts = str_replace('"', "%%''%%", $texts);
		
		$line = "Smiley = \"" . $code . ".png\", 0, \"" . $texts . "\", \"" . (isset($symbols[$names[0]]) ? $symbols[$names[0]] : $unicode) . "\"\n";
	} else {
		$line = "Smiley = \"" . $code . ".png\", 0, \"" . $unicode . "\", \"" . $unicode . "\"\n";
	}
	fwrite($file, $line);
	
	echo $line . "<br>\n";
}

fclose($file);
